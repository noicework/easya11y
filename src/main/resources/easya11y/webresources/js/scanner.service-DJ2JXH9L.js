var e=Object.defineProperty,a=(a,t,s)=>((a,t,s)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[t]=s)(a,"symbol"!=typeof t?t+"":t,s);import{o as t,l as s,m as r,O as n,j as i,C as o,F as c,G as l,H as d,B as u,P as m,Q as h,D as x,A as p,z as g,J as f,I as v}from"./globals-DING6g8V.js";
/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y=t("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),w=t("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]),j=t("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]),N=t("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),b=n("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});
/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */function k({className:e,variant:a,...t}){return s.jsx("div",{className:r(b({variant:a}),e),...t})}const C={sm:{container:"h-12 w-12",svg:"h-12 w-12",text:"text-sm",strokeWidth:4,radius:20},md:{container:"h-20 w-20",svg:"h-20 w-20",text:"text-xl",strokeWidth:6,radius:32},lg:{container:"h-32 w-32",svg:"h-32 w-32",text:"text-3xl",strokeWidth:8,radius:52}};function W({score:e,size:a="md",showLabel:t=!1,className:n}){const i=C[a],o=2*Math.PI*i.radius,c=o-e/100*o,l=(d=e)>=90?"#28a745":d>=70?"#ffc107":"#dc3545";var d;return s.jsxs("div",{className:r("relative",i.container,n),children:[s.jsxs("svg",{className:r("transform -rotate-90",i.svg),viewBox:`0 0 ${2*(i.radius+i.strokeWidth)} ${2*(i.radius+i.strokeWidth)}`,children:[s.jsx("circle",{cx:i.radius+i.strokeWidth,cy:i.radius+i.strokeWidth,r:i.radius,strokeWidth:i.strokeWidth,className:"fill-none stroke-muted"}),s.jsx("circle",{cx:i.radius+i.strokeWidth,cy:i.radius+i.strokeWidth,r:i.radius,strokeWidth:i.strokeWidth,className:"fill-none transition-all duration-500 ease-out",style:{stroke:l,strokeDasharray:o,strokeDashoffset:c,strokeLinecap:"round"}})]}),s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:s.jsx("span",{className:r("font-bold",i.text),style:{color:l},children:Math.round(e)})}),t&&s.jsx("div",{className:"mt-2 text-center",children:s.jsx("span",{className:"text-xs text-muted-foreground",children:"Score"})})]})}function A({violation:e,expanded:a=!1}){var t;const[n,f]=i.useState(a);return s.jsxs(o,{className:r("transition-all",n&&"ring-2 ring-primary"),children:[s.jsx(c,{children:s.jsxs("div",{className:"flex items-start justify-between gap-4",children:[s.jsxs("div",{className:"space-y-1.5 flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-lg",children:(e=>{switch(e){case"critical":return"ðŸ”´";case"serious":return"ðŸŸ ";case"moderate":return"ðŸŸ¡";case"minor":return"ðŸ”µ";default:return"âšª"}})(e.impact)}),s.jsx(l,{className:"text-base",children:e.help})]}),s.jsx(d,{children:e.description})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(k,{variant:(e=>{switch(e){case"critical":case"serious":return"destructive";case"moderate":return"secondary";default:return"outline"}})(e.impact),children:e.impact}),s.jsx(u,{variant:"ghost",size:"sm",onClick:()=>f(!n),children:n?s.jsx(m,{className:"h-4 w-4"}):s.jsx(h,{className:"h-4 w-4"})})]})]})}),n&&s.jsxs(x,{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(k,{variant:"outline",className:"font-mono text-xs",children:e.id}),null==(t=e.tags)?void 0:t.map((e=>s.jsx(k,{variant:"secondary",className:"text-xs",children:e},e))),e.helpUrl&&s.jsxs(u,{variant:"link",size:"sm",className:"ml-auto",onClick:()=>window.open(e.helpUrl,"_blank"),children:["Learn More",s.jsx(j,{className:"ml-1 h-3 w-3"})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"font-medium text-sm",children:["Affected Elements (",e.nodes.length,")"]}),e.nodes.slice(0,5).map(((e,a)=>s.jsxs(p,{className:"py-3",children:[s.jsx(w,{className:"h-4 w-4"}),s.jsxs(g,{className:"space-y-2",children:[s.jsx("div",{className:"font-mono text-xs overflow-x-auto",children:e.target.join(" > ")}),e.html&&s.jsx("pre",{className:"text-xs bg-muted p-2 rounded overflow-x-auto",children:s.jsx("code",{children:e.html})}),e.failureSummary&&s.jsxs("div",{className:"text-sm mt-2",children:[s.jsx(N,{className:"h-3 w-3 inline mr-1"}),e.failureSummary]})]})]},a))),e.nodes.length>5&&s.jsxs("div",{className:"text-sm text-muted-foreground text-center",children:["... and ",e.nodes.length-5," more elements"]})]})]})]})}const P=new class{constructor(){a(this,"iframeContainer",null),window.addEventListener("beforeunload",(()=>{this.cleanup()}))}initializeIframeContainer(){return this.iframeContainer||(this.iframeContainer=document.createElement("div"),this.iframeContainer.id="a11y-scanner-container",this.iframeContainer.style.cssText="\n        position: fixed;\n        top: -9999px;\n        left: -9999px;\n        width: 1px;\n        height: 1px;\n        overflow: hidden;\n        visibility: hidden;\n        pointer-events: none;\n      ",document.body.appendChild(this.iframeContainer)),this.iframeContainer}cleanupIframe(e){e&&e.parentNode&&e.parentNode.removeChild(e)}cleanup(){this.iframeContainer&&this.iframeContainer.parentNode&&(this.iframeContainer.parentNode.removeChild(this.iframeContainer),this.iframeContainer=null)}getWcagTags(e){const a=["best-practice"];switch(e){case"A":return[...a,"wcag2a","wcag21a"];case"AA":default:return[...a,"wcag2a","wcag2aa","wcag21a","wcag21aa"];case"AAA":return[...a,"wcag2a","wcag2aa","wcag2aaa","wcag21a","wcag21aa","wcag21aaa"]}}async scanPage(e){var a,t;const{scanId:s,pagePath:r,pageUrl:n,pageTitle:i,wcagLevel:o="AA"}=e,c=this.initializeIframeContainer(),l=document.createElement("iframe");l.id=`a11y-scan-${s}`,l.style.cssText="\n      width: 1280px;\n      height: 1024px;\n      border: none;\n      visibility: hidden;\n    ",l.setAttribute("aria-hidden","true"),l.setAttribute("tabindex","-1");try{c.appendChild(l),await new Promise(((e,a)=>{l.onload=()=>e(),l.onerror=()=>a(new Error("Failed to load page in iframe"));const t=setTimeout((()=>{a(new Error("Page load timeout"))}),3e4);l.addEventListener("load",(()=>{clearTimeout(t),e()}),{once:!0}),l.src=n}));try{const e=l.contentDocument||(null==(a=l.contentWindow)?void 0:a.document);if(!e)throw new Error("Cannot access iframe document");const c=e.createElement("script");c.src="https://cdnjs.cloudflare.com/ajax/libs/axe-core/4.8.3/axe.min.js",await new Promise(((a,t)=>{c.onload=()=>a(),c.onerror=()=>t(new Error("Failed to load axe-core")),e.head.appendChild(c)})),await this.delay(1e3);const d=this.getWcagTags(o),u=await l.contentWindow.axe.run({runOnly:{type:"tag",values:d},resultTypes:["violations","passes","incomplete","inapplicable"]});this.cleanupIframe(l);const m=f(u);return await v.saveScanResults({scanId:s,pagePath:r,pageUrl:n,pageTitle:i,wcagLevel:o,score:m,axeResults:{...u,toolOptions:{version:(null==(t=u.testEngine)?void 0:t.version)||"4.8.3"}}}),{...u,score:m}}catch(d){this.cleanupIframe(l);const e={violations:[],passes:[],incomplete:[],inapplicable:[],timestamp:(new Date).toISOString(),url:n,errorMessage:"Cross-origin restrictions prevent background scanning."},a=f(e);return await v.saveScanResults({scanId:s,pagePath:r,pageUrl:n,pageTitle:i+" (Cross-origin)",wcagLevel:o,score:a,axeResults:e}),{...e,score:a}}}catch(u){throw this.cleanupIframe(l),u}}async scanMultiplePages(e,a="AA",t,s=3){const r=[],n={value:0};for(let i=0;i<e.length;i+=s){const o=e.slice(i,i+s).map((async s=>{try{const r=await v.initiateScan(s.path,a),i=await this.scanPage({...r,wcagLevel:a});return n.value++,t&&t({current:n.value,total:e.length,currentPage:s.title||s.path,percentage:Math.round(n.value/e.length*100)}),{page:s.path,success:!0,violationCount:i.violations.length}}catch(r){return n.value++,t&&t({current:n.value,total:e.length,currentPage:s.title||s.path,percentage:Math.round(n.value/e.length*100)}),{page:s.path,success:!1,error:r instanceof Error?r.message:"Unknown error"}}})),c=await Promise.all(o);r.push(...c),i+s<e.length&&await this.delay(500)}return r}delay(e){return new Promise((a=>setTimeout(a,e)))}};export{y as A,k as B,j as E,W as S,A as V,P as s};
