var e=Object.defineProperty,a=(a,t,s)=>((a,t,s)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[t]=s)(a,"symbol"!=typeof t?t+"":t,s);import{o as t,l as s,m as n,O as r,j as i,C as l,G as o,H as c,I as d,B as u,P as m,Q as h,D as p,A as x,z as g,E as v,J as f}from"./globals-BigXdOGl.js";
/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w=t("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),y=t("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]),j=t("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]),b=t("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),N=r("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});
/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */function k({className:e,variant:a,...t}){return s.jsx("div",{className:n(N({variant:a}),e),...t})}const C={sm:{container:"h-12 w-12",svg:"h-12 w-12",text:"text-sm",strokeWidth:4,radius:20},md:{container:"h-20 w-20",svg:"h-20 w-20",text:"text-xl",strokeWidth:6,radius:32},lg:{container:"h-32 w-32",svg:"h-32 w-32",text:"text-3xl",strokeWidth:8,radius:52}};function S({score:e,size:a="md",showLabel:t=!1,className:r}){const i=C[a],l=2*Math.PI*i.radius,o=l-e/100*l,c=(d=e)>=90?"#28a745":d>=70?"#ffc107":"#dc3545";var d;return s.jsxs("div",{className:n("relative",i.container,r),children:[s.jsxs("svg",{className:n("transform -rotate-90",i.svg),viewBox:`0 0 ${2*(i.radius+i.strokeWidth)} ${2*(i.radius+i.strokeWidth)}`,children:[s.jsx("circle",{cx:i.radius+i.strokeWidth,cy:i.radius+i.strokeWidth,r:i.radius,strokeWidth:i.strokeWidth,className:"fill-none stroke-muted"}),s.jsx("circle",{cx:i.radius+i.strokeWidth,cy:i.radius+i.strokeWidth,r:i.radius,strokeWidth:i.strokeWidth,className:"fill-none transition-all duration-500 ease-out",style:{stroke:c,strokeDasharray:l,strokeDashoffset:o,strokeLinecap:"round"}})]}),s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:s.jsx("span",{className:n("font-bold",i.text),style:{color:c},children:Math.round(e)})}),t&&s.jsx("div",{className:"mt-2 text-center",children:s.jsx("span",{className:"text-xs text-muted-foreground",children:"Score"})})]})}function A({violation:e,expanded:a=!1}){var t;const[r,v]=i.useState(a);return s.jsxs(l,{className:n("transition-all",r&&"ring-2 ring-primary"),children:[s.jsx(o,{children:s.jsxs("div",{className:"flex items-start justify-between gap-4",children:[s.jsxs("div",{className:"space-y-1.5 flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-lg",children:(e=>{switch(e){case"critical":return"ðŸ”´";case"serious":return"ðŸŸ ";case"moderate":return"ðŸŸ¡";case"minor":return"ðŸ”µ";default:return"âšª"}})(e.impact)}),s.jsx(c,{className:"text-base",children:e.help})]}),s.jsx(d,{children:e.description})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(k,{variant:(e=>{switch(e){case"critical":case"serious":return"destructive";case"moderate":return"secondary";default:return"outline"}})(e.impact),children:e.impact}),s.jsx(u,{variant:"ghost",size:"sm",onClick:()=>v(!r),children:r?s.jsx(m,{className:"h-4 w-4"}):s.jsx(h,{className:"h-4 w-4"})})]})]})}),r&&s.jsxs(p,{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(k,{variant:"outline",className:"font-mono text-xs",children:e.id}),null==(t=e.tags)?void 0:t.map((e=>s.jsx(k,{variant:"secondary",className:"text-xs",children:e},e))),e.helpUrl&&s.jsxs(u,{variant:"link",size:"sm",className:"ml-auto",onClick:()=>window.open(e.helpUrl,"_blank"),children:["Learn More",s.jsx(j,{className:"ml-1 h-3 w-3"})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"font-medium text-sm",children:["Affected Elements (",e.nodes.length,")"]}),e.nodes.slice(0,5).map(((e,a)=>s.jsxs(x,{className:"py-3",children:[s.jsx(y,{className:"h-4 w-4"}),s.jsxs(g,{className:"space-y-2",children:[s.jsx("div",{className:"font-mono text-xs overflow-x-auto",children:Array.isArray(e.target)?e.target.join(" > "):e.target}),e.html&&s.jsx("pre",{className:"text-xs bg-muted p-2 rounded overflow-x-auto",children:s.jsx("code",{children:e.html})}),e.failureSummary&&s.jsxs("div",{className:"text-sm mt-2",children:[s.jsx(b,{className:"h-3 w-3 inline mr-1"}),e.failureSummary]})]})]},a))),e.nodes.length>5&&s.jsxs("div",{className:"text-sm text-muted-foreground text-center",children:["... and ",e.nodes.length-5," more elements"]})]})]})]})}const W=new class{constructor(){a(this,"iframeContainer",null),window.addEventListener("beforeunload",(()=>{this.cleanup()}))}initializeIframeContainer(){return this.iframeContainer||(this.iframeContainer=document.createElement("div"),this.iframeContainer.id="a11y-scanner-container",this.iframeContainer.style.cssText="\n        position: fixed;\n        top: -9999px;\n        left: -9999px;\n        width: 1px;\n        height: 1px;\n        overflow: hidden;\n        visibility: hidden;\n        pointer-events: none;\n      ",document.body.appendChild(this.iframeContainer)),this.iframeContainer}cleanupIframe(e){e&&e.parentNode&&e.parentNode.removeChild(e)}cleanup(){this.iframeContainer&&this.iframeContainer.parentNode&&(this.iframeContainer.parentNode.removeChild(this.iframeContainer),this.iframeContainer=null)}getWcagTags(e){const a=["best-practice"];switch(e){case"A":return[...a,"wcag2a","wcag21a"];case"AA":default:return[...a,"wcag2a","wcag2aa","wcag21a","wcag21aa"];case"AAA":return[...a,"wcag2a","wcag2aa","wcag2aaa","wcag21a","wcag21aa","wcag21aaa"]}}async scanPage(e){var a,t,s,n,r,i,l;const{scanId:o,pagePath:c,pageUrl:d,pageTitle:u,wcagLevel:m="AA"}=e;if(await v.shouldUseServerSideScan())try{const e=await v.serverSideScan(c,m),i=await v.getDetailedResult(c);return{violations:(null==(a=i.fullResults)?void 0:a.violations)||i.violations||[],passes:(null==(t=i.fullResults)?void 0:t.passes)||i.passes||[],incomplete:(null==(s=i.fullResults)?void 0:s.incomplete)||i.incomplete||[],inapplicable:(null==(n=i.fullResults)?void 0:n.inapplicable)||i.inapplicable||[],timestamp:(null==(r=i.fullResults)?void 0:r.timestamp)||(new Date).toISOString(),url:d,score:i.score||e.score}}catch(x){throw x}const h=this.initializeIframeContainer(),p=document.createElement("iframe");p.id=`a11y-scan-${o}`,p.style.cssText="\n      width: 1280px;\n      height: 1024px;\n      border: none;\n      visibility: hidden;\n    ",p.setAttribute("aria-hidden","true"),p.setAttribute("tabindex","-1");try{h.appendChild(p),await new Promise(((e,a)=>{p.onload=()=>e(),p.onerror=()=>a(new Error("Failed to load page in iframe"));const t=setTimeout((()=>{a(new Error("Page load timeout"))}),3e4);p.addEventListener("load",(()=>{clearTimeout(t),e()}),{once:!0}),p.src=d}));try{const e=p.contentDocument||(null==(i=p.contentWindow)?void 0:i.document);if(!e)throw new Error("Cannot access iframe document");const a=e.createElement("script");a.src="https://cdnjs.cloudflare.com/ajax/libs/axe-core/4.8.3/axe.min.js",await new Promise(((t,s)=>{a.onload=()=>t(),a.onerror=()=>s(new Error("Failed to load axe-core")),e.head.appendChild(a)})),await this.delay(1e3);const t=this.getWcagTags(m),s=await p.contentWindow.axe.run({runOnly:{type:"tag",values:t},resultTypes:["violations","passes","incomplete","inapplicable"]});this.cleanupIframe(p);const n=f(s);return await v.saveScanResults({scanId:o,pagePath:c,pageUrl:d,pageTitle:u,wcagLevel:m,score:n,axeResults:{...s,toolOptions:{version:(null==(l=s.testEngine)?void 0:l.version)||"4.8.3"}}}),{...s,score:n}}catch(g){this.cleanupIframe(p);const e={violations:[],passes:[],incomplete:[],inapplicable:[],timestamp:(new Date).toISOString(),url:d,errorMessage:"Cross-origin restrictions prevent background scanning."},a=f(e);return await v.saveScanResults({scanId:o,pagePath:c,pageUrl:d,pageTitle:u+" (Cross-origin)",wcagLevel:m,score:a,axeResults:e}),{...e,score:a}}}catch(x){throw this.cleanupIframe(p),x}}async scanMultiplePages(e,a="AA",t,s=3){const n=[],r={value:0};for(let i=0;i<e.length;i+=s){const l=e.slice(i,i+s).map((async s=>{var n;try{let i;if(await v.shouldUseServerSideScan()){const e=await v.serverSideScan(s.path,a);i={violations:(null==(n=(await v.getDetailedResult(s.path)).fullResults)?void 0:n.violations)||[],score:e.score}}else{const e=await v.initiateScan(s.path,a);i=await this.scanPage({...e,wcagLevel:a})}return r.value++,t&&t({current:r.value,total:e.length,currentPage:s.title||s.path,percentage:Math.round(r.value/e.length*100)}),{page:s.path,success:!0,violationCount:i.violations.length}}catch(i){return r.value++,t&&t({current:r.value,total:e.length,currentPage:s.title||s.path,percentage:Math.round(r.value/e.length*100)}),{page:s.path,success:!1,error:i instanceof Error?i.message:"Unknown error"}}})),o=await Promise.all(l);n.push(...o),i+s<e.length&&await this.delay(500)}return n}delay(e){return new Promise((a=>setTimeout(a,e)))}};export{w as A,k as B,j as E,S,A as V,W as s};
