import{j as e,l as s,C as a,D as t,L as i,A as n,z as l,J as r,F as c,K as m,R as o,M as d,N as x}from"./globals-p1I7djjd.js";import{s as h,A as u,S as g,V as f}from"./scanner.service-CKuaqTng.js";function j(){var m;const[o,d]=e.useState(!0),[x,j]=e.useState(null),[p,N]=e.useState(null);e.useEffect((()=>{y()}),[]);const y=async()=>{try{const e=new URLSearchParams(window.location.search),s=e.get("pageUrl"),a=e.get("scanId"),t=e.get("pagePath"),i=e.get("pageTitle")||"Unknown Page",n=e.get("wcagLevel")||"AA";if(!s||!a||!t)throw new Error("Missing required parameters");const l=await h.scanPage({scanId:a,pagePath:t,pageUrl:s,pageTitle:i,wcagLevel:n});N(l)}catch(e){j(e instanceof Error?e.message:"Scan failed")}finally{d(!1)}};if(o)return s.jsx("div",{className:"flex h-screen items-center justify-center bg-background p-4",children:s.jsx(a,{className:"w-full max-w-md",children:s.jsxs(t,{className:"flex flex-col items-center py-12",children:[s.jsx(i,{className:"mb-4 h-12 w-12 animate-spin text-primary"}),s.jsx("p",{className:"text-lg font-medium",children:"Running accessibility scan..."}),s.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:"This may take a moment"})]})})});if(x)return s.jsx("div",{className:"flex h-screen items-center justify-center bg-background p-4",children:s.jsxs(n,{variant:"destructive",className:"max-w-md",children:[s.jsx(u,{className:"h-4 w-4"}),s.jsxs(l,{children:[s.jsx("strong",{children:"Scan failed:"})," ",x]})]})});if(!p)return null;const b=r(p),v=p.violations||[],w=v.length,S=(null==(m=p.passes)?void 0:m.length)||0,A=v.reduce(((e,s)=>{var a;return e+((null==(a=s.nodes)?void 0:a.length)||0)}),0),P={critical:v.filter((e=>"critical"===e.impact)).length,serious:v.filter((e=>"serious"===e.impact)).length,moderate:v.filter((e=>"moderate"===e.impact)).length,minor:v.filter((e=>"minor"===e.impact)).length};return s.jsx("div",{className:"min-h-screen bg-background p-6",children:s.jsx(a,{className:"mx-auto max-w-4xl",children:s.jsxs(t,{className:"p-6",children:[s.jsxs("div",{className:"mb-8 flex items-center gap-8",children:[s.jsx(g,{score:b,size:"lg"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h2",{className:"text-2xl font-semibold",children:"Accessibility Score"}),s.jsxs("div",{className:"mt-2 space-y-1 text-sm text-muted-foreground",children:[s.jsxs("p",{children:["Violations: ",s.jsx("strong",{className:"text-foreground",children:w})]}),s.jsxs("p",{children:["Passed Rules: ",s.jsx("strong",{className:"text-foreground",children:S})]}),s.jsxs("p",{children:["Total Issues: ",s.jsx("strong",{className:"text-foreground",children:A})]})]})]})]}),s.jsxs("div",{className:"mb-8 flex flex-wrap gap-2",children:[P.critical>0&&s.jsxs("span",{className:"inline-flex items-center rounded-full bg-a11y-critical px-3 py-1 text-xs font-medium text-white",children:["Critical: ",P.critical]}),P.serious>0&&s.jsxs("span",{className:"inline-flex items-center rounded-full bg-a11y-serious px-3 py-1 text-xs font-medium text-white",children:["Serious: ",P.serious]}),P.moderate>0&&s.jsxs("span",{className:"inline-flex items-center rounded-full bg-a11y-moderate px-3 py-1 text-xs font-medium text-white",children:["Moderate: ",P.moderate]}),P.minor>0&&s.jsxs("span",{className:"inline-flex items-center rounded-full bg-a11y-minor px-3 py-1 text-xs font-medium text-gray-900",children:["Minor: ",P.minor]}),0===w&&s.jsxs("div",{className:"flex items-center gap-2 text-a11y-success",children:[s.jsx(c,{className:"h-5 w-5"}),s.jsx("span",{className:"font-medium",children:"No violations found!"})]})]}),v.length>0&&s.jsxs("div",{children:[s.jsx("h3",{className:"mb-4 text-lg font-semibold",children:"Accessibility Issues"}),s.jsx("div",{className:"space-y-4",children:["critical","serious","moderate","minor"].map((e=>v.filter((s=>s.impact===e)).map((e=>s.jsx(f,{violation:e},e.id)))))})]}),0===v.length&&s.jsxs(n,{className:"border-a11y-success bg-a11y-success/10",children:[s.jsx(c,{className:"h-4 w-4 text-a11y-success"}),s.jsxs(l,{className:"text-a11y-success",children:[s.jsx("strong",{children:"Great job!"})," No accessibility violations were found on this page."]})]})]})})})}m.createRoot(document.getElementById("root")).render(s.jsx(o.StrictMode,{children:s.jsx(d,{children:s.jsx(x,{variant:"dialog",children:s.jsx(j,{})})})}));
